        -:    0:Source:unittest1.c
        -:    0:Graph:unittest1.gcno
        -:    0:Data:unittest1.gcda
        -:    0:Runs:2
        -:    0:Programs:1
        -:    1:/* jonest3
        -:    2: * Unit Test 1*/
        -:    3:
        -:    4:#include "dominion.h"
        -:    5:#include "dominion_helpers.h"
        -:    6:#include "rngs.h"
        -:    7:#include "getCard.h"
        -:    8:#include <stdio.h>
        -:    9:#include <math.h>
        -:   10:#include <stdlib.h>
        -:   11:#include <string.h>
        -:   12:#include <time.h>
        -:   13:
        -:   14:#define UNITTEST "updateCoins"
        -:   15:
        -:   16:const char* getCardName(enum CARD card);
        -:   17:
function main called 2 returned 100% blocks executed 89%
        2:   18:int main(){
        2:   19:   printf("TESTING %s\n", UNITTEST);
call    0 returned 100%
        2:   20:   printf("MAX_HAND = %d\n", MAX_HAND);
call    0 returned 100%
        2:   21:   printf("MAX_PLAYERS = %d\n", MAX_PLAYERS);
call    0 returned 100%
        -:   22:
        -:   23:   // set up cards and hands
        -:   24:   int *arrayOfHands[8];
        -:   25:
        -:   26:   int allCopper[MAX_HAND];
        -:   27:   int allSilver[MAX_HAND];
        -:   28:   int allGold[MAX_HAND];
        -:   29:   int copperSilver[MAX_HAND];
        -:   30:   int silverGold[MAX_HAND];
        -:   31:   int goldCopper[MAX_HAND];
        -:   32:   int allThree[MAX_HAND];
        -:   33:   int mixedHand[MAX_HAND];
        -:   34:   
        -:   35:   int i,j;
        -:   36:
     1002:   37:   for(j = 0; j < MAX_HAND; j++){
branch  0 taken 99%
branch  1 taken 1% (fallthrough)
        -:   38:	// set up 3 pure decks
     1000:   39:	allCopper[j] = copper;
     1000:   40:	allSilver[j] = silver;
     1000:   41:	allGold[j] = gold;
     1000:   42:	mixedHand[j] = gold;
     1000:   43:	allThree[j] = gold;
     1000:   44:	copperSilver[j] = silver;
     1000:   45:	silverGold[j] = gold;
     1000:   46:	goldCopper[j] = copper;
        -:   47:
        -:   48:	// set up mixed deck
     1000:   49:	if(j % 2 == 0)
branch  0 taken 50% (fallthrough)
branch  1 taken 50%
      500:   50:		mixedHand[j] = curse;
      500:   51:	else if(j % 6 == 0)
branch  0 taken 0% (fallthrough)
branch  1 taken 100%
    #####:   52:		mixedHand[j] = estate;
      500:   53:	else if(j % 5 == 0)
branch  0 taken 20% (fallthrough)
branch  1 taken 80%
      100:   54:               	mixedHand[j] = duchy;
      400:   55:        else if(j % 4 == 0)
branch  0 taken 0% (fallthrough)
branch  1 taken 100%
    #####:   56:       	        mixedHand[j] = province;
      400:   57:        else if(j % 3 == 0){
branch  0 taken 33% (fallthrough)
branch  1 taken 67%
      132:   58:	        mixedHand[j] = copper;
      132:   59:		allThree[j] = copper;
        -:   60:	}
      268:   61:       	else if(j % 2 != 0){
branch  0 taken 100% (fallthrough)
branch  1 taken 0%
      268:   62:               	mixedHand[j] = silver;
      268:   63:		allThree[j] = silver;
      268:   64:                copperSilver[j] = copper;
      268:   65:                silverGold[j] = silver;
      268:   66:                goldCopper[j] = gold;
        -:   67:	}
        -:   68:    }
        -:   69:
        2:   70:    arrayOfHands[0] = allCopper;
        2:   71:    arrayOfHands[1] = allSilver;
        2:   72:    arrayOfHands[2] = allGold;
        2:   73:    arrayOfHands[3] = copperSilver;
        2:   74:    arrayOfHands[4] = silverGold;
        2:   75:    arrayOfHands[5] = goldCopper;
        2:   76:    arrayOfHands[6] = allThree;
        2:   77:    arrayOfHands[7] = mixedHand;
        -:   78: 
        -:   79:    int factor;
        -:   80:    int numPlayers;
        -:   81:    struct gameState G;
        2:   82:    int k[10] = {adventurer, gardens, embargo, village, minion, mine, cutpurse, 
        -:   83:  	         sea_hag, tribute, smithy};
        2:   84:    int bonus = 0;
        2:   85:    int seed = 10000;
        -:   86:    int currentHand;
        2:   87:    int success = 1;
        -:   88:    int copperCount;
        -:   89:    int silverCount;
        -:   90:    int goldCount;
        -:   91:
       18:   92:    for(i = 0; i < 8; i++){
branch  0 taken 89%
branch  1 taken 11% (fallthrough)
       16:   93:        if(i == 0){
branch  0 taken 13% (fallthrough)
branch  1 taken 88%
        2:   94:                factor = 1;
        2:   95:                printf("----------Testing ALL COPPER\n");
call    0 returned 100%
        -:   96:        }
       14:   97:        else if(i == 1){
branch  0 taken 14% (fallthrough)
branch  1 taken 86%
        2:   98:                factor = 2;
        2:   99:                printf("----------Testing ALL SILVER\n");
call    0 returned 100%
        -:  100:        }
       12:  101:        else if(i == 2){
branch  0 taken 17% (fallthrough)
branch  1 taken 83%
        2:  102:                factor = 3;
        2:  103:                printf("----------Testing ALL GOLD\n");
call    0 returned 100%
        -:  104:        }
       10:  105:        else if(i == 3)
branch  0 taken 20% (fallthrough)
branch  1 taken 80%
        2:  106:                printf("----------Testing COPPER & SILVER\n");
call    0 returned 100%
        8:  107:        else if(i == 4)
branch  0 taken 25% (fallthrough)
branch  1 taken 75%
        2:  108:                printf("----------Testing SILVER & GOLD\n");
call    0 returned 100%
        6:  109:        else if(i == 5)
branch  0 taken 33% (fallthrough)
branch  1 taken 67%
        2:  110:                printf("----------Testing GOLD & COPPER\n");
call    0 returned 100%
        4:  111:        else if(i == 6)
branch  0 taken 50% (fallthrough)
branch  1 taken 50%
        2:  112:                printf("----------Testing ALL THREE\n");
call    0 returned 100%
        -:  113:        else
        2:  114:                printf("----------Testing MIXED HAND\n");
call    0 returned 100%
        -:  115:
       64:  116:   	for(numPlayers = 2; numPlayers <= MAX_PLAYERS; numPlayers++){
branch  0 taken 75%
branch  1 taken 25% (fallthrough)
       48:  117:		printf("\n----------TESTING FOR %d PLAYERS----------\n", numPlayers);
call    0 returned 100%
       48:  118:		memset(&G, 23, sizeof(struct gameState));
       48:  119:		initializeGame(MAX_PLAYERS, k, seed, &G);
call    0 returned 100%
        -:  120:
        -:  121:		int player;
      240:  122:		for(player = 1; player <= MAX_PLAYERS; player++){
branch  0 taken 80%
branch  1 taken 20% (fallthrough)
      192:  123:			printf("Player %d:\n", player);
call    0 returned 100%
        -:  124:
     1152:  125:			for(currentHand = 0; currentHand < 5; currentHand++){
branch  0 taken 83%
branch  1 taken 17% (fallthrough)
      960:  126:				G.handCount[player] = currentHand;
      960:  127:				printf("--Current Hand Size: %d\n", G.handCount[player]);
call    0 returned 100%
        -:  128://                                printf("--Current Hand Size: %d\n", currentHand);
        -:  129:
      960:  130:				memcpy(G.hand[player], arrayOfHands[i], sizeof(int) * MAX_HAND);
        -:  131:
      960:  132:                                printf("--Current Hand Size: %d\n", G.handCount[player]);
call    0 returned 100%
      960:  133:				G.handCount[player] = currentHand;
      960:  134:  				updateCoins(player, &G, bonus);
call    0 returned 100%
        -:  135:
        -:  136:				int y;
        -:  137:
        -:  138://                              printf("--Current Hand Size: %d\n", G.handCount[player]);
        -:  139://				G.hand[player][3] = copper;
        -:  140://				G.hand[player][4] = copper;
        -:  141:
        -:  142://                                G.handCount[player] = currentHand;
        -:  143:
        -:  144://				G.hand[player][5] = copper;
        -:  145://				G.hand[player][6] = copper;
     2880:  146:				for(y = 0; y < G.handCount[player]; y++){
branch  0 taken 67%
branch  1 taken 33% (fallthrough)
     1920:  147:					printf("Card: %s\n", getCardName(G.hand[player][y]));
call    0 returned 100%
call    1 returned 100%
     1920:  148:					printf("y = %d and handCount = %d\n", y, G.handCount[player]);
call    0 returned 100%
        -:  149:				}
      960:  150:				if(i < 3){
branch  0 taken 38% (fallthrough)
branch  1 taken 63%
      360:  151:					if(G.coins !=  G.handCount[player] * factor)
branch  0 taken 0% (fallthrough)
branch  1 taken 100%
        -:  152:					{
    #####:  153:						success = 0;
    #####:  154:						printf("Error for Player %d at hand %d.\n", player, G.handCount[player]); 	
call    0 never executed
    #####:  155:						printf("G.coins  = %d\n", G.coins);
call    0 never executed
    #####:  156:						printf("Expected = %d\n", G.handCount[player] * factor);
call    0 never executed
    #####:  157:						return 0;
        -:  158:					} 
        -:  159:				}
        -:  160:				else{
        -:  161:	     	                        int y;
      600:  162:	                                copperCount = 0;
      600:  163:                	                silverCount = 0;
      600:  164:                        	        goldCount = 0;
        -:  165:
     1800:  166:                                	for(y = 0; y < G.handCount[player]; y++){
branch  0 taken 67%
branch  1 taken 33% (fallthrough)
     1200:  167:	       	                                if(G.hand[player][y] == copper)
branch  0 taken 24% (fallthrough)
branch  1 taken 76%
      288:  168:                	                                copperCount += 1;
      912:  169:                        	                else if(G.hand[player][y] == silver)
branch  0 taken 42% (fallthrough)
branch  1 taken 58%
      384:  170:                                	                silverCount += 1;
      528:  171:	                                        else if(G.hand[player][y] == gold)
branch  0 taken 73% (fallthrough)
branch  1 taken 27%
      384:  172:        	                                        goldCount += 1;
        -:  173:	                                }
        -:  174:
        -:  175:					int coinSum;
        -:  176:
      600:  177:					if(i == 3)
branch  0 taken 20% (fallthrough)
branch  1 taken 80%
      120:  178:						coinSum = (copperCount * 1) + (silverCount * 2);
      480:  179:					else if(i == 4)
branch  0 taken 25% (fallthrough)
branch  1 taken 75%
      120:  180:						coinSum = (silverCount * 2) + (goldCount * 3);
      360:  181:					else if(i == 5)
branch  0 taken 33% (fallthrough)
branch  1 taken 67%
      120:  182:						coinSum = (goldCount * 3) + (copperCount * 1);
        -:  183:					else
      240:  184:						coinSum = (goldCount * 3) + (silverCount * 2) + (copperCount * 1);
        -:  185:					
      600:  186:					if(G.coins != coinSum){
branch  0 taken 0% (fallthrough)
branch  1 taken 100%
    #####:  187:						success = 0;
    #####:  188:						printf("Error for Player %d at hand %d.\n", player, G.handCount[player]);
call    0 never executed
    #####:  189:						printf("G.coins  = %d\n", G.coins);
call    0 never executed
    #####:  190:						printf("Expected = %d\n", coinSum);
call    0 never executed
    #####:  191:						return 0;
        -:  192:					}	
        -:  193:				}
        -:  194:			}
      192:  195:			if(success)
branch  0 taken 100% (fallthrough)
branch  1 taken 0%
      192:  196:				printf("Test = PASSED\n");
call    0 returned 100%
        -:  197://			if(player != MAX_PLAYERS){
        -:  198://				printf("Press [ENTER] to see next player.\n");
        -:  199://				while(getchar() != '\n');
        -:  200://			}
        -:  201:		}
        -:  202:   	}
        -:  203://	if( i != 8){
        -:  204://		printf("Press [ENTER] to test next hand combination.\n");
        -:  205://		while(getchar() != '\n');
        -:  206://	}
        -:  207:   }
        2:  208:   return 0;
        -:  209:}
